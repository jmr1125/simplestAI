cmake_minimum_required(VERSION 3.3)
set(CMAKE_CXX_STANDARD 20)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
project(myAI)
if(APPLE)
execute_process( COMMAND brew --prefix libomp
		OUTPUT_VARIABLE HOMEBREW_LIBOMP_PREFIX
		OUTPUT_STRIP_TRAILING_WHITESPACE)
set(OpenMP_C_FLAGS
"-Xpreprocessor -fopenmp -I${HOMEBREW_LIBOMP_PREFIX}/include/")
set(OpenMP_CXX_FLAGS
"-Xpreprocessor -fopenmp -I${HOMEBREW_LIBOMP_PREFIX}/include/")
set(OpenMP_C_LIB_NAMES omp)
set(OpenMP_CXX_LIB_NAMES omp)
set(OpenMP_omp_LIBRARY ${HOMEBREW_LIBOMP_PREFIX}/lib/libomp.dylib)
set(${OpenMP_C_INCLUDE_DIR} "${HOMEBREW_LIBOMP_PREFIX}/include")
set(${OpenMP_CXX_INCLUDE_DIR} "${HOMEBREW_LIBOMP_PREFIX}/include")
endif()
find_package(OpenMP)

message(STATUS --FLAGS---)
message(STATUS "C  :${OpenMP_C_FLAGS}")
message(STATUS "CXX:${OpenMP_CXX_FLAGS}")
message(STATUS --LIBNAME---)
message(STATUS "C  :${OpenMP_C_LIB_NAMES}")
message(STATUS "CXX:${OpenMP_CXX_LIB_NAMES}")
message(STATUS --INCLUDEDIR---)
message(STATUS "C  :${OpenMP_C_INCLUDE_DIR}")
message(STATUS "CXX:${OpenMP_CXX_INCLUDE_DIR}")
message(STATUS "LIB:${OpenMP_omp_LIBRARY}")
message(STATUS ------)
set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} ${OpenMP_C_FLAGS}")
set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} ${OpenMP_CXX_FLAGS}")
if(OpenMP_CXX_FOUND)
message(STATUS "has omp")
set(USE_OMP ON)
else()
message(STATUS "no omp")
set(USE_OMP OFF)
endif()

add_executable(test1 testomp.cpp)
target_link_libraries(test1 OpenMP::OpenMP_CXX)
add_executable(test2 test2.cpp matrix.cpp layer.cpp network.cpp)
